(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[76],{243:(e,t,s)=>{"use strict";s.d(t,{E:()=>o});var a=s(5155),r=s(4269);function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...s})}},854:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(2115),r=s(4901);let o=()=>{let e=(0,a.useContext)(r.c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3998:(e,t,s)=>{"use strict";s.d(t,{$:()=>d});var a=s(5155),r=s(2115),o=s(7129),n=s(3101),l=s(4269);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:s,variant:r,size:n,asChild:d=!1,...c}=e,u=d?o.DX:"button";return(0,a.jsx)(u,{className:(0,l.cn)(i({variant:r,size:n,className:s})),ref:t,...c})});d.displayName="Button"},4269:(e,t,s)=>{"use strict";s.d(t,{cn:()=>o});var a=s(2821),r=s(5889);function o(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},4901:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>i,c:()=>l});var a=s(5155),r=s(2115),o=s(63),n=s(5183);let l=(0,r.createContext)(void 0);function i(e){let{children:t}=e,[s,i]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0),u=(0,o.useRouter)();(0,r.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token");if(!e){let t=document.cookie.match(RegExp("(^| )auth_token=([^;]+)"));t&&(e=t[2],localStorage.setItem("token",e))}if(console.log("[AuthProvider] Loading user from token. Token exists:",!!e),e)try{let e=await (0,n.rQ)();console.log("[AuthProvider] User loaded successfully:",e),i(e)}catch(e){console.error("[AuthProvider] Failed to load user",e),localStorage.removeItem("token"),document.cookie="auth_token=; path=/; max-age=0"}else console.log("[AuthProvider] No token found");c(!1)})()},[]);let m=async(e,t)=>{c(!0);try{let{token:s}=await (0,n.Lx)(e,t);localStorage.setItem("token",s),document.cookie="auth_token=".concat(s,"; path=/; max-age=").concat(604800,"; SameSite=Lax");let a=await (0,n.rQ)();i(a)}finally{c(!1)}},f=async(e,t,s,a)=>{c(!0);try{await (0,n.DY)(e,t,s,a)}finally{c(!1)}};return(0,a.jsx)(l.Provider,{value:{user:s,isAuthenticated:!!s,isLoading:d,login:m,register:f,logout:()=>{localStorage.removeItem("token"),document.cookie="auth_token=; path=/; max-age=0",i(null),u.push("/login")}},children:t})}},5183:(e,t,s)=>{"use strict";s.d(t,{DY:()=>n,FH:()=>a,Lx:()=>r,rQ:()=>o});let a=s(5125).A.create({baseURL:"/api/v1"});a.interceptors.request.use(e=>{let t=localStorage.getItem("token");if(!t&&"undefined"!=typeof document){let e=document.cookie.match(RegExp("(^| )auth_token=([^;]+)"));e&&(t=e[2])}return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let r=async(e,t)=>{try{console.log("[API] Attempting login for:",e);let s=await a.post("/auth/login",{email:e,senha:t});return console.log("[API] Login response status:",s.status),console.log("[API] Login response data:",s.data),s.data}catch(e){var s,r,o,n,l;throw console.error("[API] Login Error Details:",{message:e.message,response:null==(s=e.response)?void 0:s.data,status:null==(r=e.response)?void 0:r.status,headers:null==(o=e.response)?void 0:o.headers}),Error((null==(l=e.response)||null==(n=l.data)?void 0:n.message)||"Invalid email or password")}},o=async()=>{try{let e=(await a.get("/usuarios/me/profile")).data;return{id:e.id,name:e.nome,username:e.email.split("@")[0],email:e.email,avatarUrl:e.fotoUrl||"https://placehold.co/100x100?text=User"}}catch(a){var e,t,s;throw console.error("[API] Fetch Profile Error:",{status:null==(e=a.response)?void 0:e.status,data:null==(t=a.response)?void 0:t.data,headers:null==(s=a.response)?void 0:s.headers,message:a.message}),Error("Failed to fetch user profile")}},n=async(e,t,s,r)=>{try{return(await a.post("/auth/register",{name:e,username:t,email:s,password:r})).data}catch(e){var o,n;throw Error((null==(n=e.response)||null==(o=n.data)?void 0:o.message)||"Registration failed")}}},5897:(e,t,s)=>{"use strict";s.d(t,{Avatar:()=>l,AvatarFallback:()=>d,AvatarImage:()=>i});var a=s(5155),r=s(2115),o=s(7870),n=s(4269);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(o.bL,{ref:t,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r})});l.displayName=o.bL.displayName;let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(o._V,{ref:t,className:(0,n.cn)("aspect-square h-full w-full",s),...r})});i.displayName=o._V.displayName;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(o.H4,{ref:t,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r})});d.displayName=o.H4.displayName},7719:(e,t,s)=>{Promise.resolve().then(s.bind(s,9105))},9105:(e,t,s)=>{"use strict";s.d(t,{default:()=>P});var a=s(5155),r=s(2619),o=s.n(r),n=s(3998),l=s(854),i=s(5897),d=s(2115),c=s(3749),u=s(3263),m=s(2251),f=s(5797),h=s(4269);let p=c.bL,x=c.l9,g=c.YJ;c.ZL,c.Pb,c.z6,d.forwardRef((e,t)=>{let{className:s,inset:r,children:o,...n}=e;return(0,a.jsxs)(c.ZP,{ref:t,className:(0,h.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...n,children:[o,(0,a.jsx)(u.A,{className:"ml-auto"})]})}).displayName=c.ZP.displayName,d.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(c.G5,{ref:t,className:(0,h.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}).displayName=c.G5.displayName;let v=d.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...o}=e;return(0,a.jsx)(c.ZL,{children:(0,a.jsx)(c.UC,{ref:t,sideOffset:r,className:(0,h.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...o})})});v.displayName=c.UC.displayName;let j=d.forwardRef((e,t)=>{let{className:s,inset:r,...o}=e;return(0,a.jsx)(c.q7,{ref:t,className:(0,h.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...o})});j.displayName=c.q7.displayName,d.forwardRef((e,t)=>{let{className:s,children:r,checked:o,...n}=e;return(0,a.jsxs)(c.H_,{ref:t,className:(0,h.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:o,...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(c.VF,{children:(0,a.jsx)(m.A,{className:"h-4 w-4"})})}),r]})}).displayName=c.H_.displayName,d.forwardRef((e,t)=>{let{className:s,children:r,...o}=e;return(0,a.jsxs)(c.hN,{ref:t,className:(0,h.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(c.VF,{children:(0,a.jsx)(f.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=c.hN.displayName;let N=d.forwardRef((e,t)=>{let{className:s,inset:r,...o}=e;return(0,a.jsx)(c.JU,{ref:t,className:(0,h.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...o})});N.displayName=c.JU.displayName;let b=d.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(c.wv,{ref:t,className:(0,h.cn)("-mx-1 my-1 h-px bg-muted",s),...r})});b.displayName=c.wv.displayName;var y=s(7187),w=s(7314),k=s(5253),A=s(6710),_=s(8428),L=s(243);function P(){let{isAuthenticated:e,user:t,logout:s,isLoading:r}=(0,l.A)();return(0,a.jsx)("header",{className:"sticky top-0 z-50 w-full border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,a.jsxs)("div",{className:"container flex h-14 max-w-screen-2xl items-center",children:[(0,a.jsxs)(o(),{href:"/",className:"mr-6 flex items-center space-x-2",children:[(0,a.jsx)(y.A,{className:"h-6 w-6 text-primary"}),(0,a.jsx)("span",{className:"font-bold font-headline",children:"LetterBook"})]}),e&&(0,a.jsxs)("nav",{className:"flex items-center gap-6 text-sm",children:[(0,a.jsx)(o(),{href:"/feed",className:"transition-colors hover:text-foreground/80 text-foreground/60",children:"Feed"}),(0,a.jsx)(o(),{href:"/books",className:"transition-colors hover:text-foreground/80 text-foreground/60",children:"Livros"}),(0,a.jsx)(o(),{href:"/lists",className:"transition-colors hover:text-foreground/80 text-foreground/60",children:"Listas"}),(0,a.jsx)(o(),{href:"/communities",className:"transition-colors hover:text-foreground/80 text-foreground/60",children:"Comunidades"})]}),(0,a.jsx)("div",{className:"flex flex-1 items-center justify-end space-x-4",children:r?(0,a.jsx)(L.E,{className:"h-8 w-20"}):e&&t?(0,a.jsxs)(p,{children:[(0,a.jsx)(x,{asChild:!0,children:(0,a.jsx)(n.$,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,a.jsxs)(i.Avatar,{className:"h-8 w-8",children:[(0,a.jsx)(i.AvatarImage,{src:t.avatarUrl,alt:t.name}),(0,a.jsx)(i.AvatarFallback,{children:t.name.charAt(0)})]})})}),(0,a.jsxs)(v,{className:"w-56",align:"end",forceMount:!0,children:[(0,a.jsx)(N,{className:"font-normal",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium leading-none",children:t.name}),(0,a.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:t.email})]})}),(0,a.jsx)(b,{}),(0,a.jsxs)(g,{children:[(0,a.jsx)(j,{asChild:!0,children:(0,a.jsxs)(o(),{href:"/profile",children:[(0,a.jsx)(w.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Perfil"})]})}),(0,a.jsx)(j,{asChild:!0,children:(0,a.jsxs)(o(),{href:"/lists",children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Minhas Listas"})]})}),(0,a.jsx)(j,{asChild:!0,children:(0,a.jsxs)(o(),{href:"/rankings",children:[(0,a.jsx)(A.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Rankings"})]})})]}),(0,a.jsx)(b,{}),(0,a.jsxs)(j,{onClick:s,children:[(0,a.jsx)(_.A,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.$,{variant:"ghost",asChild:!0,children:(0,a.jsx)(o(),{href:"/login",children:"Login"})}),(0,a.jsx)(n.$,{asChild:!0,children:(0,a.jsx)(o(),{href:"/register",children:"Sign Up"})})]})})]})})}}},e=>{e.O(0,[909,619,977,128,485,441,255,358],()=>e(e.s=7719)),_N_E=e.O()}]);